<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8"/>
        <title>Consulta API Escolas</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    </head>
    <body>
        <div class="container">
            <h1>Consulta API Escolas</h1>
            <form>
                <div class="mb-3">
                    <label for="inputEscola" class="form-label">Insira um ID de alguma escola:</label>
                    <input type="text" class="form-control" id="inputEscola">
                </div>
                <button class="btn btn-primary" type="button" onClick="trataConsultarBtn()">Consultar</button>
                <button class="btn btn-primary" type="button" onClick="trataLimparBtn()">Limpar</button>
            </form>
            <p id="escolaResponse"></p>
        </div>
        


        <script>
            function trataConsultarBtn() {
                // Apresenta GIF de "loading"
               
                //limpaResultados();
                
                const escola = document.getElementById("inputEscola").value;
                const urlEscola = `https://simcaq.c3sl.ufpr.br/api/v1/school?filter=id:${escola}`;
                fetch(urlEscola, {
                    method : "GET",
                })
                .then( (resp) => resp.json() )
                .then( (data) => {
                    //tratar o resultado "data" no formato json
                    apresentaResultadoEscola(data);
                })

            }

            function apresentaResultadoEscola(data) {
                // Remove GIF de "loading"
               
            
                var elem = document.getElementById('escolaResponse');
                console.log(data)

                var resultados=data.result;
                elem.innerHTML += resultados[0].name + "</br>";
                elem.innerHTML += resultados[0].state_id + "</br>";
                elem.innerHTML += resultados[0].city_id;
            }

            function trataLimparBtn() {
                limpaInputs();
                limpaResultados();
            }

            function limpaInputs() {
                document.getElementById("inputEscola").value = '';
            }

            function limpaResultados() {
                document.getElementById("escolaResponse").innerHTML = ''
            }

        </script>
    </body>

</html>